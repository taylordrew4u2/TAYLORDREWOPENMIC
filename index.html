
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Taylor Drew Timer</title>
<!-- Digital-7 font from Google Fonts (or fallback) -->
<!-- Swis721 BlkEx BT font via CDN (if available), fallback to Arial Black/Impact -->
<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/swis721-blkex-bt" />
<style>
  :root {
    --bg: #000;
    --fg: #fff;
    --accent: #ff2b2b;
  }
  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    margin: 0;
    background: var(--bg);
    color: var(--fg);
    display: flex;
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  }

  /* Layout: top marquee, middle timer, bottom controls */
  .wrap {
    display: flex;
    flex-direction: column;
    height: 100vh;
    width: 100vw;
  }

  /* Tiny scrolling marquee at the top */
  .marquee-outer {
    position: relative;
    overflow: hidden;
    height: 20px;
    padding: 2px 0;
  }
  .marquee-track {
    position: absolute;
    white-space: nowrap;
    will-change: transform;
    animation: scroll-left 12s linear infinite;
    font-family: "Times New Roman", Times, serif;
    font-size: 12px; /* very small */
    letter-spacing: .5px;
    opacity: .85;
  }
  @keyframes scroll-left {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
  }

  /* Timer area */
  .timer-area {
    flex: 1 1 auto;
    display: grid;
    place-items: center;
    padding: 2vmin;
    position: relative;
  }

  #timer {
    font-family: 'Swis721 BlkEx BT', 'Arial Black', Impact, Arial, sans-serif;
    font-variant-numeric: tabular-nums;
    font-size: clamp(16vw, 40vmin, 60vw); /* even larger and responsive */
    font-weight: 900;
    line-height: 0.8;
    letter-spacing: 1.8vmin;
    text-align: center;
    user-select: none;
    /* white bold effect */
    text-shadow:
      0 0 12px #fff,
      0 0 32px #fff,
      0 0 64px #fff,
      0 0 4px #fff,
      0 0 12px rgba(255,255,255,0.45),
      0 0 32px rgba(255,255,255,0.25);
    color: #fff;
    background: #111;
    border-radius: 0.2em;
    padding: 0.18em 0.7em;
    box-shadow: 0 0 18px #fff2, 0 0 8px #fff2;
    width: 100%;
    max-width: 100vw;
    box-sizing: border-box;
    display: inline-block;
  }
  #timer.red {
    color: #ff2b2b;
    text-shadow:
      0 0 8px #ff2b2b,
      0 0 24px #ff2b2b,
      0 0 2px #fff,
      0 0 8px rgba(255,43,43,0.6),
      0 0 24px rgba(255,43,43,0.35);
    background: #300;
    box-shadow: 0 0 8px #ff2b2b2a, 0 0 2px #fff2;
  }

  /* Bottom row buttons: exactly 4, white font + white outline */
  .controls {
    display: flex;
    gap: 6px;
    justify-content: center;
    align-items: center;
    margin-top: 1.5vmin;
    margin-bottom: 0;
    padding: 0;
    position: relative;
    width: 100%;
    max-width: 90vw;
  }
  .btn {
    flex: 0 1 auto;
    background: transparent;
    color: var(--fg);
    border: 2px solid var(--fg);
    border-radius: 10px;
    padding: 6px 8px;
    font-size: clamp(12px, 2.2vmin, 16px);
    font-weight: 700;
    text-transform: none;
    letter-spacing: .2px;
    outline: none;
    cursor: pointer;
    touch-action: manipulation;
    min-width: 48px;
    min-height: 32px;
  }
  .btn:active { transform: scale(0.98); }
  .btn:focus-visible { box-shadow: 0 0 0 2px rgba(255,255,255,0.25); }

  /* Flashing red screen when <= 60s */
  #flash {
    position: fixed;
    inset: 0;
    pointer-events: none;
    background: rgba(255,0,0,0);
    display: none;
    z-index: 5;
    animation: flashRed 0.8s ease-in-out infinite alternate;
  }
  body.flash #flash { display: block; }
  @keyframes flashRed {
    from { background: rgba(255,0,0,0.12); }
    to   { background: rgba(255,0,0,0.45); }
  }

  /* Solid red overlay for 5 seconds at 0:00 */
  #solid {
    position: fixed;
    inset: 0;
    background: var(--accent);
    display: none;
    z-index: 10;
  }
  body.solid #solid { display: block; }

  /* Minimal toast for “Exit” limitation */
  #toast {
    position: fixed;
    left: 50%;
    bottom: calc(70px + env(safe-area-inset-bottom));
    transform: translateX(-50%);
    background: rgba(0,0,0,.7);
    color: #fff;
    padding: 10px 14px;
    border-radius: 10px;
    font-size: 14px;
    display: none;
    z-index: 20;
    max-width: 90vw;
    text-align: center;
  }
  #toast.show { display: block; }

  /* Make sure content never causes scrolling */
  html, body { overflow: hidden; }
</style>
</head>
<body>
  <div id="flash" aria-hidden="true"></div>
  <div id="solid" aria-hidden="true"></div>
  <div id="toast" role="status" aria-live="polite">Browsers don’t allow pages to exit themselves.</div>

  <!-- Fullscreen button in the top-right corner -->
  <button id="fullscreenBtn" title="Go Fullscreen" aria-label="Go Fullscreen" style="
    position: fixed;
    top: 16px;
    right: 16px;
    z-index: 100;
    background: rgba(0,0,0,0.7);
    color: #0ff;
    border: 2px solid #0ff;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    font-size: 1.6em;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 2px 8px #000a;
    transition: background 0.2s;
  ">
    <span style="pointer-events:none;">⛶</span>
  </button>

  <div class="wrap">
    <div class="marquee-outer" aria-hidden="true">
      <div class="marquee-track">the Taylor drew review &nbsp; • &nbsp; the Taylor drew review &nbsp; • &nbsp; the Taylor drew review &nbsp; • &nbsp;</div>
    </div>

    <main class="timer-area">
      <div id="timer" aria-label="Countdown Timer">5:00</div>
      <div class="controls">
        <!-- Down and Up buttons on the sides, Start and Reset together in the center, Exit at the end -->
        <button class="btn" id="downBtn" title="Down 10s">▼ −10s</button>
        <span style="display: flex; gap: 6px; align-items: center;">
          <button class="btn" id="startBtn" title="Start / Pause">Start</button>
          <button class="btn" id="resetBtn" title="Reset Timer">Reset</button>
        </span>
        <button class="btn" id="exitBtn" title="Exit">Exit</button>
        <button class="btn" id="upBtn" title="Up 10s">▲ +10s</button>
      </div>
    </main>
  </div>

<script>
(() => {
  // Fullscreen button logic
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  function isFullscreen() {
    return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;
  }
  function requestFullscreen(elem) {
    if (elem.requestFullscreen) return elem.requestFullscreen();
    if (elem.webkitRequestFullscreen) return elem.webkitRequestFullscreen();
    if (elem.mozRequestFullScreen) return elem.mozRequestFullScreen();
    if (elem.msRequestFullscreen) return elem.msRequestFullscreen();
  }
  function exitFullscreen() {
    if (document.exitFullscreen) return document.exitFullscreen();
    if (document.webkitExitFullscreen) return document.webkitExitFullscreen();
    if (document.mozCancelFullScreen) return document.mozCancelFullScreen();
    if (document.msExitFullscreen) return document.msExitFullscreen();
  }
  fullscreenBtn.addEventListener('click', () => {
    if (!isFullscreen()) {
      requestFullscreen(document.documentElement);
    } else {
      exitFullscreen();
    }
  });

  const timerEl = document.getElementById('timer');
  const startBtn = document.getElementById('startBtn');
  const upBtn = document.getElementById('upBtn');
  const downBtn = document.getElementById('downBtn');
  const exitBtn = document.getElementById('exitBtn');
  const resetBtn = document.getElementById('resetBtn');
  const toastEl = document.getElementById('toast');
  function resetTimer() {
    isRunning = false;
    deadline = null;
    pausedRemaining = baseSeconds;
    startBtn.textContent = 'Start';
    updateImmediate();
  }

  const SOLID_MS = 5000;
  let baseSeconds = 300;          // default 5 minutes
  let isRunning = false;
  let deadline = null;            // timestamp (ms) when countdown hits 0
  let pausedRemaining = baseSeconds;
  let solidUntil = 0;             // timestamp (ms) until which solid red is shown
  let rafId = 0;

  function format(seconds) {
    seconds = Math.max(0, Math.floor(seconds));
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    return `${m}:${String(s).padStart(2, '0')}`;
  }

  function now() { return Date.now(); }

  function remainingSeconds() {
    if (document.body.classList.contains('solid')) return 0;
    if (isRunning && deadline) {
      return Math.ceil((deadline - now()) / 1000);
    } else {
      return pausedRemaining;
    }
  }

  function setRemaining(newSeconds) {
    newSeconds = Math.max(0, Math.min(36000, newSeconds)); // clamp 0..10h
    if (isRunning && deadline) {
      // Adjust deadline so visual time jumps immediately
      deadline = now() + newSeconds * 1000;
    } else {
      pausedRemaining = newSeconds;
    }
    updateImmediate();
  }

  function start() {
    if (document.body.classList.contains('solid')) return; // ignore during solid screen
    if (!isRunning) {
      const startFrom = remainingSeconds();
      deadline = now() + startFrom * 1000;
      isRunning = true;
      startBtn.textContent = 'Pause';
    }
  }

  function pause() {
    if (isRunning) {
      pausedRemaining = remainingSeconds();
      isRunning = false;
      deadline = null;
      startBtn.textContent = 'Start';
    }
  }

  function toggleStart() {
    if (isRunning) pause(); else start();
  }

  function showToast(msg, ms = 1800) {
    toastEl.textContent = msg;
    toastEl.classList.add('show');
    setTimeout(() => toastEl.classList.remove('show'), ms);
  }

  function tryExit() {
    // Try to close; most browsers will ignore it unless opened via script
    window.close();
    showToast("Browsers don’t allow pages to exit themselves.");
  }

  function enterSolid() {
    document.body.classList.remove('flash');
    document.body.classList.add('solid');
    isRunning = false;
    deadline = null;
    solidUntil = Date.now() + SOLID_MS;
  }

  function maybeLeaveSolid() {
    if (document.body.classList.contains('solid') && Date.now() >= solidUntil) {
      document.body.classList.remove('solid');
      // Auto-reset to base and keep running
      pausedRemaining = baseSeconds;
      isRunning = true;
      deadline = Date.now() + pausedRemaining * 1000;
      startBtn.textContent = 'Pause';
    }
  }

  function updateImmediate() {
    const rem = remainingSeconds();
    timerEl.textContent = format(rem);
    if (rem <= 60 && !document.body.classList.contains('solid')) {
      timerEl.classList.add('red');
      document.body.classList.add('flash');
    } else {
      timerEl.classList.remove('red');
      document.body.classList.remove('flash');
    }
  }

  function tick() {
    rafId = requestAnimationFrame(tick);

    // if in solid-red phase, check exit
    if (document.body.classList.contains('solid')) {
      maybeLeaveSolid();
      return;
    }

    if (isRunning) {
      const rem = remainingSeconds();
      if (rem <= 0) {
        timerEl.textContent = "0:00";
        enterSolid();
        return;
      }
    }
    updateImmediate();
  }

  // Button wiring
  startBtn.addEventListener('click', toggleStart);
  upBtn.addEventListener('click', () => setRemaining(remainingSeconds() + 10));
  downBtn.addEventListener('click', () => setRemaining(remainingSeconds() - 10));
  exitBtn.addEventListener('click', tryExit);
  resetBtn.addEventListener('click', resetTimer);

  // Keep correct after backgrounding (page may throttle timers)
  document.addEventListener('visibilitychange', () => {
    // Recompute immediately on return
    updateImmediate();
  });
  window.addEventListener('focus', updateImmediate);
  window.addEventListener('resize', updateImmediate);
  window.addEventListener('orientationchange', updateImmediate);

  // Start paused at 5:00
  updateImmediate();
  cancelAnimationFrame(rafId);
  tick(); // kick off render loop

  // Auto-reset behavior after finish is handled in enterSolid()/maybeLeaveSolid()

})();
</script>
</body>
</html>

